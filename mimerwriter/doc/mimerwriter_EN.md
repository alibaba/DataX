# DataX MimerWriter


---


## 1 Brief Intro

The MimerWriter plubin helps to write data into the destination tables in a Mimer SQL database. It is implemented using JDBC to connect to a Mimer SQL database, and execute correspoinding INSERT statements.


## 2 Implementation

MimerWriter receives data generated by a Reader through the DataX framwork. Depending on your `writeMode`, the following statements are generated and executed:


* `insert into...`(`writeMode` is insert，returns error when primary key or unique constraint conflict occurs);

##### or

* `insert {replace} into ...`(`writeMode` is replace，replaces the original row when primary key or unique constraint conflict occurs); 

##### or

* `insert {ignore} into ...`(`writeMode` is ignore，ignores the statement when primary key or unique constraint conflict occurs). 


<br />

    Note: The user needs at least insert privilege on the table. Other privileges may be needed, depending on the statements in preSql and postSql.


## 3 Specification

### 3.1 Job configuration example

* Here is an example to load data from memory into Mimer SQL using MimerWriter.

```json
{
    "job": {
        "setting": {
            "speed": {
                "channel": 1
            }
        },
        "content": [
            {
                 "reader": {
                    "name": "streamreader",
                    "parameter": {
                        "column" : [
                            {
                                "value": "DataX",
                                "type": "string"
                            },
                            {
                                "value": 19880808,
                                "type": "long"
                            },
                            {
                                "value": "1988-08-08 08:08:08",
                                "type": "date"
                            },
                            {
                                "value": true,
                                "type": "bool"
                            },
                            {
                                "value": "test",
                                "type": "bytes"
                            }
                        ],
                        "sliceRecordCount": 1000
                    }
                },
                "writer": {
                    "name": "mimerwriter",
                    "parameter": {
                        "username": "xx",
                        "password": "xx",
                        "column": [
                            "id",
                            "name"
                        ],
                        "preSql": [
                            "delete from test"
                        ],
                        "connection": [
                            {
                                "jdbcUrl": "jdbc:mimer://localhost:1360/datax",
                                "table": [
                                    "test"
                                ]
                            }
                        ]
                    }
                }
            }
        ]
    }
}

```


### 3.2 Parameters

* **jdbcUrl**

  * JDBC connection string of the destination.
      
    JDBC URL must follow Mimer SQL specifications, and arguments can be attached in the string. More details are referred to Mimer JDBC documentation (https://developer.mimer.com/article/jdbc/).

  * Mandatory: yes <br />

  * Default: no default value <br />

* **username**

  * User name of the database <br />

  * Mandatory: yes <br />

  * Default: no default value <br />

* **password**

  * Password of the user <br />

  * Mandatory: yes <br />

  * Default: no default value <br />

* **table**

  * Destination table. This can be several tables, but they must have the same definition.

  * Mandatory: yes <br />

  * Default: no default value <br />

* **column**

  * Columns to be inserted in the destination table. Use `,` to separate them. For example,  `"column": ["id","name","age"]`. You can use `*` to represent all tables: `"column": ["*"]`.

    Note: no contants or literals can be used here.

  * Mandatory: yes <br />

  * Default: no default value <br />

* **preSql**

  * Execute the SQL statements here before writing the data to the destination table. <br />

  * Mandatory: no <br />

  * Default: no default value <br />

* **postSql**

  * Execute the SQL statements here after writing the data to the destination table. <br />

  * Mandatory: no <br />

  * Default: no default value <br />

* **writeMode**

	* Control the insert statements to use `insert into`, `insert {replace} into` or `insert {ignore} into`.<br />

	* Mandatory: yes <br />
	
	* Options: insert/replace/ignore <br />

	* Default: insert <br />

* **batchSize**

	* Insert records in batches. A large batch can reduce the communication between DataX and the database server, and improve throughput. But it may also cause DataX to run out of memory.<br />

	* Mandatory: no <br />

	* Default: no default value <br />

### 3.3 Data tpes

MimerWriter supports most data types in Mimer SQL, but may not be complete.

Data types converted between DataX internal types and Mimer SQL types:

| DataX internal | Mimer SQL data type    |
| -------- | -----  |
| Long     |bigint, integer, smallint |
| Double   |double precision, numeric, real, float, decimal |
| String   |varchar, char, clob|
| Date     |date, time, timestamp |
| Boolean  |bool|
| Bytes    |binary, varbinary, blob|
